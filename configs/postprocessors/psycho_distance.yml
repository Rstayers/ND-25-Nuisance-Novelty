# configs/postprocessors/psycho.yaml

postprocessor:
  name: psycho          # same class

  postprocessor_args:
    # FT
    ft_epochs: 1
    ft_lr: 5.0e-4
    ft_weight_decay: 0.0

    # psychophysics
    min_severity: 1
    max_severity: 5
    weight_min: 0.5
    weight_max: 2.0
    inverse: False

    # energy
    energy_T: 1.0

    # KEY: emphasize ID shaping, de-emphasize OOD shaping
    lambda_in: 0.3        # ↑ from 0.1
    lambda_out: 0.0       # pure ID-only energy shaping

    # margins (we'll make these severity-dependent in code)
    id_margin: -6.0
    ood_margin: 0.0       # unused if lambda_out=0.0, but keep for safety

    use_clean_id: True


    # -------------------------
    # Psycho ImageNet-C dataset
    # -------------------------
    # Txt file should contain lines of the form:
    #   path/to/image.jpg label_index
    # where paths encode severity (or you provide batch["severity"] in the dataset).
    psych_imglist_pth: ./data/benchmark_imglist/imagenet/test_imagenet_c.txt
    psych_data_dir:     ./data/images_largescale/  # root containing ImageNet-C images

    # -------------------------
    # Logging / debug
    # -------------------------
    log_stats: True

    # -------------------------
    # APS search ranges (used only if APS_mode=True)
    # OpenOOD’s Evaluator.hyperparam_search() will sweep over these.
    # -------------------------
    ft_epochs_list: [1, 2]
    ft_lr_list: [5.0e-4, 1.0e-4]
    ft_weight_decay_list: [0.0]
    weight_min_list: [0.5]
    weight_max_list: [2.0]
    inverse_list: [False]
