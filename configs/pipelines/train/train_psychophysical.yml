exp_name: "'@{dataset.name}'_'@{network.name}'_'@{trainer.name}'_e'@{optimizer.num_epochs}'_lr'@{optimizer.lr}'_'@{mark}'/s'@{seed}'"
output_dir: ./results/
save_output: True
merge_option: default
mark: default
seed: 0

num_gpus: 1
num_workers: 8
num_machines: 1
machine_rank: 0

preprocessor:
  name: base

network:
  name: resnet50
  num_classes: 1000
  pretrained: True

pipeline:
  name: train

trainer:
  name: psychophysical   # <-- our custom trainer

evaluator:
  name: base

optimizer:
  name: sgd
  num_epochs: 30
  lr: 0.001
  momentum: 0.9
  weight_decay: 0.0005

augment:
  randaugment:
    num_ops: 2
    magnitude: 9
  random_resized_crop: true
  random_horizontal_flip: true
scheduler:
  name: multistep
  milestones: [10, 20]
  gamma: 0.1

dataset:
  name: imagenet_c_psycho
  num_classes: 1000
  pre_size: 256
  image_size: 224
  interpolation: bilinear
  normalization_type: imagenet

  num_workers: '@{num_workers}'
  num_gpus: '@{num_gpus}'
  num_machines: '@{num_machines}'

  split_names: [train, val, test]

  # train on ImageNet (clean) + a subset of ImageNet-C (we’ll weight by severity)
  train:
    dataset_class: PsychoImglistDataset         # <-- our dataset wrapper
    data_dir: ./data/images_largescale/
    imglist_pth: ./data/benchmark_imglist/imagenet_c_psycho/train_imagenet_c_psycho.txt
    batch_size: 128
    shuffle: True
    inetc_weighting:
      mode: "severity"         # map ImageNet-C severities → weights
      epsilon: 0.05            # floor so weights never hit exactly 0

  # plain ImageNet val
  val:
    dataset_class: PsychoImglistDataset
    data_dir: ./data/images_largescale/
    imglist_pth: ./data/benchmark_imglist/imagenet_c_psycho/val_imagenet_c_psycho.txt
    batch_size: 128
    shuffle: False
    inetc_weighting:
      mode: "severity"
      epsilon: 0.05   # harmless, weights aren't used in val loss

  test:
    dataset_class: PsychoImglistDataset
    data_dir: ./data/images_largescale/
    imglist_pth: ./data/benchmark_imglist/imagenet_c_psycho/test_imagenet_c_psycho.txt
    batch_size: 128
    shuffle: False
    inetc_weighting:
      mode: "severity"
      epsilon: 0.05

